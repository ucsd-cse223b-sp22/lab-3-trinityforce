import matplotlib.pyplot as plt
import numpy as np

def log_lock_6000():
    op_count = np.array([1500, 3000, 4500, 6000])
    lock_rw7 = np.array([14.930, 29.791, 44.279, 58.267])
    log_rw7 = np.array([18.637, 39.349, 59.221, 85.278])
    lock_rw3 = np.array([14.506, 28.781, 42.347, 56.472])
    log_rw3 = np.array([16.254, 35.588, 55.881, 78.659])
    fig = plt.figure()
    plt.xlabel("Number of operations")
    plt.ylabel("Time")
    plt.title("#Opration v.s. Time")
    plt.plot(op_count, lock_rw3, 'r--', linewidth=2, label = "lock-7:3")
    plt.plot(op_count, log_rw3, 'r-', linewidth=2, label = "log-7:3")
    plt.plot(op_count, lock_rw7, 'b--', linewidth=2, label = "lock-3:7")
    plt.plot(op_count, log_rw7, 'b-', linewidth=2, label = "log-3:7")
    plt.plot(op_count, log_rw3-lock_rw3, 'r:', linewidth=2, label = "diff-log-lock-7:3")
    plt.plot(op_count, log_rw7-lock_rw7, 'b:', linewidth=2, label = "diff-log-lock-3:7")
    plt.legend()
    fig.savefig("log_lock_performance_6000.png")
    plt.close(fig)

def log_lock_10000():
    op_count = np.array([1500, 3000, 4500, 6000, 10000])
    lock_rw7 = np.array([14.930, 29.791, 44.279, 58.267, 142.495])
    log_rw7 = np.array([18.637, 39.349, 59.221, 85.278, 204.917])
    lock_rw3 = np.array([14.506, 28.781, 42.347, 56.472, 134.691])
    log_rw3 = np.array([16.254, 35.588, 55.881, 78.659, 197.379])
    fig = plt.figure()
    plt.xlabel("Number of operations")
    plt.ylabel("Time")
    plt.title("#Opration v.s. Time")
    plt.plot(op_count, lock_rw3, 'r--', linewidth=2, label = "lock-7:3")
    plt.plot(op_count, log_rw3, 'r-', linewidth=2, label = "log-7:3")
    plt.plot(op_count, lock_rw7, 'b--', linewidth=2, label = "lock-3:7")
    plt.plot(op_count, log_rw7, 'b-', linewidth=2, label = "log-3:7")
    plt.plot(op_count, log_rw3-lock_rw3, 'r:', linewidth=2, label = "diff-log-lock-7:3")
    plt.plot(op_count, log_rw7-lock_rw7, 'b:', linewidth=2, label = "diff-log-lock-3:7")
    plt.legend()
    fig.savefig("log_lock_performance_10000.png")
    plt.close(fig)


def log_lock_concurrency():
    num_client = np.array([1, 3, 5, 8])
    lock_rw37 = np.array([29.508, 32.214, 44.836, 70.437])
    log_rw37 = np.array([37.939, 52.426, 82.995, 172.922])
    lock_rw73 = np.array([28.677, 31.666, 42.527, 67.055])
    log_rw73 = np.array([34.107, 47.653, 78.562, 162.807])
    fig = plt.figure()
    plt.xlabel("Number of clients")
    plt.ylabel("Time")
    plt.title("#Client v.s. Time")
    plt.plot(num_client, lock_rw73, 'r--', linewidth=2, label = "lock-7:3")
    plt.plot(num_client, log_rw73, 'r-', linewidth=2, label = "log-7:3")
    plt.plot(num_client, lock_rw37, 'b--', linewidth=2, label = "lock-3:7")
    plt.plot(num_client, log_rw37, 'b-', linewidth=2, label = "log-3:7")
    plt.plot(num_client, log_rw37-lock_rw37, 'r:', linewidth=2, label = "diff-log-lock-7:3")
    plt.plot(num_client, log_rw73-lock_rw73, 'b:', linewidth=2, label = "diff-log-lock-3:7")
    plt.legend()
    fig.savefig("log_lock_concurrency.png")
    plt.close(fig)


def log_lock_speedup():
    num_client = np.array([1, 3, 5, 8])
    lock_rw37 = np.array([1.000, 2.654, 3.173, 3.223])
    log_rw37 = np.array([1.000, 2.768, 3.537, 3.371])
    lock_rw73 = np.array([1.000, 2.626, 3.252, 3.291])
    log_rw73 = np.array([1.000, 2.807, 3.395, 3.328])
    fig = plt.figure()
    
    plt.xlabel("Number of clients")
    plt.ylabel("Scaling ratio")
    plt.title("#Client v.s. Scaling ratio")
    plt.plot(num_client, lock_rw73, 'r--', linewidth=2, label = "lock-7:3")
    plt.plot(num_client, log_rw73, 'r-', linewidth=2, label = "log-7:3")
    plt.plot(num_client, lock_rw37, 'b--', linewidth=2, label = "lock-3:7")
    plt.plot(num_client, log_rw37, 'b-', linewidth=2, label = "log-3:7")
    plt.plot(num_client, num_client, 'k:', linewidth=2, label = "ideal")
    plt.legend()
    fig.savefig("log_lock_speedup.png")
    plt.close(fig)


log_lock_6000()
log_lock_10000()
log_lock_concurrency()
log_lock_speedup()